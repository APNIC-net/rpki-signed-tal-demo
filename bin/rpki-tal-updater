#!/usr/bin/perl

use warnings;
use strict;

use Getopt::Long;

use APNIC::RPKI::TALUpdater;

sub usage
{
    print <<EOF;
Usage:
$0 --tal {tal-path}

This takes the TAL at `{tal-path}`, finds the TAK issued under that
TA, and then continues resolving TAs/TAKs until it reaches an
unrevoked key.  It then writes the earliest unrevoked current key in
TAL format to `{tal-path}`.
EOF

    exit(10);
}

my %options;
GetOptions(\%options, 'tal=s');
if (not $options{'tal'}) {
    print "Please provide a TAL path.\n";
    usage();
}

my $tal_path = $options{'tal'};

my $tal_updater =
    APNIC::RPKI::TALUpdater->new(
        tal_path => $tal_path,
    );
$tal_updater->run();

1;
